<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gaming Site</title>

    <link rel="stylesheet" href="style.css" />

    <!-- Ethers (EVM only) --> 
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

    <!-- Receiver Logic -->
    <script type="module" src="./receiver.js" defer></script>
</head>

<body>

       <!-- ================= WALLET ================= -->
    <section class="card">
        <h2>Receiver Wallet</h2>

        <button id="connectWalletBtn">Connect Wallet</button>
        <button id="disconnectWalletBtn" style="display:none;">Disconnect</button>

        <p id="account" class="muted"></p>
        <p id="network" class="muted"></p>


    </section>

    <!-- ================= CREATE EMI ================= -->
    <section class="card">
        <h2>Create</h2>

        <!-- Blockchain -->
        <label>Blockchain</label>
        <select id="blockchainSelect"></select>

        <!-- Token -->
        <label>Token</label>
        <select id="tokenSelect"></select>

        <label>Token Address</label>
        <input id="tokenAddressDisplay" type="text" disabled />

        <!-- EMI -->
        <label>Amount Per Interval</label>
        <input id="emiAmount" type="number" placeholder="e.g. 100" />

        <!-- Interval -->
        <label>Payment Interval</label>
        <select id="intervalSelect">
            <option value="3600">1 Hour</option>
            <option value="10800">3 Hours</option>
            <option value="21600">6 Hours</option>
            <option value="43200">12 Hours</option>
            <option value="86400">Daily</option>
            <option value="604800">Weekly</option>
            <option value="2592000">Monthly</option>
            <option value="custom">Custom (minutes)</option>
        </select>

        <input id="customInterval" type="number" placeholder="Minutes" style="display:none;" />

        <!-- Total -->
        <label>Total Amount</label>
        <input id="totalAmount" type="number" placeholder="e.g. 1200" />

        <button id="createPlanBtn" class="primary-btn">
            Create Plan
        </button>
    </section>

    <!-- ================= SHARE WITH SENDER ================= -->
    <!-- ================= SHARE WITH SENDER ================= -->
    <section class="card success" id="shareSection" style="display:none;">
        

        <label>MetaMask Deep Link (Mobile)</label>
        <div class="row">
            <input id="metamaskLinkOutput" type="text" readonly />
            <button onclick="copyText('metamaskLinkOutput')">üìã Copy</button>
        </div>
        <label>Trust Wallet App Link</label>
        <div class="row">
            <input id="trustwalletLinkOutput" type="text" readonly />
            <button onclick="copyText('trustwalletLinkOutput')">üìã Copy</button>
        </div>


        <label>Scan QR (Any Wallet)</label>
        <div class="qr-container">
            <div class="qr-box">
                <h4>ü¶ä Scan with MetaMask</h4>
                <canvas id="qrCanvasMetamask"></canvas>
                <button onclick="copyQR('qrCanvasMetamask')">üìã Copy QR</button>
            </div>

            <div class="qr-box">
                <h4>üü¢ Scan with Trust Wallet</h4>
                <canvas id="qrCanvasTrust"></canvas>
                <button onclick="copyQR('qrCanvasTrust')">üìã Copy QR</button>
            </div>
        </div>
    </section>


   
    

    <script>
        function copyText(id) {
            const el = document.getElementById(id);
            el.select();
            document.execCommand("copy");
        }
    </script>

    <script>
        async function copyQR(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return alert("QR not found");

            canvas.toBlob(async (blob) => {
                try {
                    await navigator.clipboard.write([
                        new ClipboardItem({ "image/png": blob })
                    ]);
                    alert("‚úÖ QR copied to clipboard");
                } catch (err) {
                    console.error(err);
                    alert("‚ùå Clipboard copy not supported on this browser");
                }
            });
        }
    </script>



</body>

</html>